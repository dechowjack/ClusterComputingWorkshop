#!/bin/bash
#SBATCH -J test_add_job          
#SBATCH -p LocalQ          
#SBATCH -t 00:05:00         
#SBATCH --ntasks=1         
#SBATCH -o OUT/test.out
#SBATCH --mail-type=BEGIN,END,FAIL
#SBATCH --mail-user=jldechow@unc.edu
#SBATCH --mem 1GB

set -x  # helpful debug: prints commands as they run

# Always work from the directory where you ran 'sbatch'
cd "$SLURM_SUBMIT_DIR"
mkdir -p OUT

# Paths 
src_file="$HOME/ClusterComputingWorkshop/ExampleScripts/test_add.py"

# Use node-local scratch if the cluster provides it; otherwise fallback

# Stage the script to scratch
cp "$src_file" "$SLURM_SUBMIT_DIR/"
work_file="$tmpdir/test_add.py"

# Run the script
python3 "$work_file" 8 5 

# Bring results back to the submit directory
cp $SLURM_SUBMIT_DIR/OUT/* "$HOME/OUT/"

echo "Job done: $SLURM_JOB_NAME ($SLURM_JOB_ID)"